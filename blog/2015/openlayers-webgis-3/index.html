<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Gábor Farkas | WebGIS application with OpenLayers 2 - Part 3: Data management</title>
  <meta name="description" content="My personal site.">

  <link rel="shortcut icon" href="https://gaborfarkas.github.io/assets/img/favicon.ico">

  <link rel="stylesheet" href="https://gaborfarkas.github.io/assets/css/main.css">
  <link rel="canonical" href="https://gaborfarkas.github.io/blog/2015/openlayers-webgis-3/">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    
    <span class="site-title">
        
        Gábor Farkas
    </span>
    

    <nav class="site-nav">

      <div class="trigger">
        <!-- About -->
        <a class="page-link" href="https://gaborfarkas.github.io/">about</a>

        <!-- Blog -->
        <a class="page-link" href="https://gaborfarkas.github.io/blog/">blog</a>

        <!-- Pages -->
        
          
        
          
            <a class="page-link" href="https://gaborfarkas.github.io/cv/">CV</a>
          
        
          
        
          
        
          
            <a class="page-link" href="https://gaborfarkas.github.io/publications/">publications</a>
          
        
          
            <a class="page-link" href="https://gaborfarkas.github.io/stuff/">stuff</a>
          
        
          
        
          
        
          
        

      </div>
    </nav>

  </div>

</header>



    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">WebGIS application with OpenLayers 2 - Part 3: Data management</h1>
    <p class="post-meta">March 17, 2015</p>
  </header>

  <article class="post-content">
    <style type="text/css">
tbody {
    vertical-align: top;
}
#layerControl_wrap img {
    padding: 0px;
}
#layerControl_wrap {
    width: 200px;
    max-height: 500px;
    overflow: auto;
    padding: 0px;
}
#layerControl_wrap p {
    width: 100px;
    word-break: break-all;
    display: inline-table;
}
#layerControl_wrap input {
    width: 20px;
    height: 20px;
    margin: 0px 0px 0px 4px;
}
#layerControl_wrap input[type=button] {
    position: relative;
    bottom: 3px;
}
    .olControlPanel .olButton {
        top: 5px;
        position: relative;
        left: 100px;
        background-repeat: no-repeat;
        background-color: #EBEBE6;
        margin: 0 0 5px 5px;
        width: 24px;
        height: 22px;
        cursor: pointer;
        float: left;
        border-radius: 5px 5px 5px 5px;
        border: 1px grey solid;
    }
.olControlPanel .olControlZoomToMaxExtentItemInactive { 
    background-image: url("http://openlayers.org/api/img/zoom-world-mini.png");
    background-size: contain;
    background-position: 1px 0px;
}
.olControlPanel .olControlNavigationHistory {
    background-image: url("http://openlayers.org/api/theme/default/img/navigation_history.png");
}
    .olControlPanel .olControlMeasureItemActive {
        background-image: url("http://openlayers.org/api/img/measuring-stick-on.png");
        background-size: contain;
        background-position: 1px 0px;
    }
    .olControlPanel .olControlMeasureItemInactive {
        background-image: url("http://openlayers.org/api/img/measuring-stick-off.png");
        background-size: contain;
        background-position: 1px 0px;
    }
    .olControlPanel .olControlGraticuleItemActive {
        background-image: url("http://seadas.gsfc.nasa.gov/help/visat/images/icons/GraticuleOverlay24.gif");
        background-size: contain;
        filter: hue-rotate(180deg);
        -webkit-filter: hue-rotate(180deg);
    }
    .olControlPanel .olControlGraticuleItemInactive {
        background-image: url("http://seadas.gsfc.nasa.gov/help/visat/images/icons/GraticuleOverlay24.gif");
        background-size: contain;
    }
    .olControlPanel .olControlSelectFeatureItemInactive {
        background-image: url("https://docs.qgis.org/2.2/en/_images/mActionSelect.png");
        background-size: contain;
        left: -55px;
        top: 35px;
    }
    .olControlPanel .olControlSelectFeatureItemActive {
        background-image: url("https://docs.qgis.org/2.2/en/_images/mActionSelect.png");
        background-size: contain;
        filter: hue-rotate(180deg);
        -webkit-filter: hue-rotate(180deg);
        left: -55px;
        top: 35px;
    }
    .olControlPanel .olControlAttributeTableItemInactive {
        background-image: url("http://grass.osgeo.org/grass71/manuals/icons/table.png");
        background-size: contain;
        left: -55px;
        top: 35px;
    }
    .olControlPanel .olControlAttributeTableItemActive {
        background-image: url("http://grass.osgeo.org/grass71/manuals/icons/table.png");
        background-size: contain;
        filter: hue-rotate(180deg);
        -webkit-filter: hue-rotate(180deg);
        left: -55px;
        top: 35px;
    }
    .olControlEditingToolbar .olButton {
        background-color: #EBEBE6;
        border-radius: 5px 5px 5px 5px;
    }
    .olControlEditingToolbar .olControlModifyFeatureItemActive { 
        background-image: url("http://junichi11.com/wp-content/uploads/2011/01/tool-node-editor.png");
        background-size: contain;
        filter: hue-rotate(180deg);
        -webkit-filter: hue-rotate(180deg);
    }
    .olControlEditingToolbar .olControlModifyFeatureItemInactive { 
        background-image: url("http://junichi11.com/wp-content/uploads/2011/01/tool-node-editor.png");
        background-size: contain;
    }
    .olControlEditingToolbar .olControlDragFeatureItemActive { 
        background-image: url("http://openlayers.org/api/theme/default/img/move_feature_on.png");
    }
    .olControlEditingToolbar .olControlDragFeatureItemInactive { 
        background-image: url("http://openlayers.org/api/theme/default/img/move_feature_off.png");
    }
    .olControlEditingToolbar .olControlDeleteFeatureItemActive { 
        background-image: url("http://openlayers.org/api/theme/default/img/remove_point_on.png");
    }
    .olControlEditingToolbar .olControlDeleteFeatureItemInactive { 
        background-image: url("http://openlayers.org/api/theme/default/img/remove_point_off.png");
    }
    .olControlEditingToolbar .olControlSnappingItemActive { 
        background-image: url("http://tavmjong.free.fr/INKSCAPE/MANUAL/images/ICONS_PNG/status/snap.png");
        background-size: contain;
        filter: hue-rotate(180deg);
        -webkit-filter: hue-rotate(180deg);
    }
    .olControlEditingToolbar .olControlSnappingItemInactive { 
        background-image: url("http://tavmjong.free.fr/INKSCAPE/MANUAL/images/ICONS_PNG/status/snap.png");
        background-size: contain;
    }
    .olControlEditingToolbar .olControlEditAttributeItemActive { 
        background-image: url("https://cdn2.iconfinder.com/data/icons/aspneticons_v1.0_Nov2006/database_table_(edit)_16x16.gif");
        background-size: contain;
        filter: hue-rotate(180deg);
        -webkit-filter: hue-rotate(180deg);
    }
    .olControlEditingToolbar .olControlEditAttributeItemInactive { 
        background-image: url("https://cdn2.iconfinder.com/data/icons/aspneticons_v1.0_Nov2006/database_table_(edit)_16x16.gif");
        background-size: contain;
    }
    .menuToggle {
        width: 100px;
        float: left;
        cursor: pointer;
        -moz-appearance: button;
        -moz-user-select: none;
        -webkit-appearance: button;
        -webkit-user-select: none;
    }
    .menuContent {
        list-style: none;
        position: absolute;
        width: inherit;
    }
    .menuContent div {
        border: 1px solid black;
        cursor: default;
        background-color: #FFFFFF;
        position: relative;
        z-index: 9999;
        border-top-width: 0px;
    }
    .menuContent div:hover {
        background-color: #CEE3F6;
    }
    .attributeTable {
        max-width: 670px;
        max-height: 500px;
        overflow: scroll;
        float: left;
    }
    .attributeTable td {
        padding-right: 10px;
        white-space: nowrap;
    }
    .attributeTable th {
        padding-right: 10px;
        white-space: nowrap;
    }
    .attributeCloseButton {
        width: 20px;
        height: 20px;
        overflow: hidden;
        cursor: pointer;
        text-align: center;
        border: 1px solid black;
    }
    .popupForm div {
        width: 100px;
        display: inline-block;
        overflow: hidden;
        word-wrap: normal;
    }
    .popupForm input[type=text] {
        width: 100px;
    }
svg {
        max-height: initial;
    }
</style>

<p>In the last part of the series, we will cover data management in OpenLayers 2. It is a quite difficult part, as browsers mostly don’t have native support for relational databases. The only exceptions are browsers powered by WebKit. This way, we have to make sure manually, that our data is stored in a consistent way. ASCII geodata formats, which are mainly used in web mapping environments don’t support databases. We can store different attributes for every geometry in a layer/dataset. This doesn’t seem to be an issue on the first glance, as web mapping libraries can handle object-oriented databases very well. However, if you declare attributes arbitrary, in an inconsistent way, you will have a hard time when you try to process it with a RDBMS. As the server side processing GIS softwares (e.g. QGIS, GRASS, PostGIS) will put these datasets into a relational database, it might be a wise consideration to handle features like they were in a relational table on the frontend.</p>

<h3 id="html-and-css">HTML and CSS</h3>

<p>The HTML and CSS parts of the final example are quite easy to understand, as they’re mostly just simple extensions to the previous ones. We’re defining three new controls, an attribute table, and a popup to assign attributes to newly created features. We also implement a new menu to filter layers with user specified expressions.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code>.attributeTable {
    max-width: 900px;
    max-height: 500px;
    overflow: scroll;
    float: left;
}
.attributeTable td {
    padding-right: 10px;
    white-space: nowrap;
}
.attributeTable th {
    padding-right: 10px;
    white-space: nowrap;
}
.attributeCloseButton {
    width: 20px;
    height: 20px;
    overflow: hidden;
    cursor: pointer;
    text-align: center;
    border: 1px solid black;
}
.popupForm div {
    width: 100px;
    display: inline-block;
    overflow: hidden;
}
.popupForm input[type=text] {
    width: 100px;
}

.olControlEditingToolbar .olControlEditAttributeItemActive { 
    background-image: url("https://cdn2.iconfinder.com/data/icons/aspneticons_v1.0_Nov2006/database_table_(edit)_16x16.gif");
    background-size: contain;
    filter: hue-rotate(180deg);
    -webkit-filter: hue-rotate(180deg);
}
.olControlEditingToolbar .olControlEditAttributeItemInactive { 
    background-image: url("https://cdn2.iconfinder.com/data/icons/aspneticons_v1.0_Nov2006/database_table_(edit)_16x16.gif");
    background-size: contain;
}
.olControlPanel .olControlSelectFeatureItemInactive {
    background-image: url("https://docs.qgis.org/2.2/en/_images/mActionSelect.png");
    background-size: contain;
}
.olControlPanel .olControlSelectFeatureItemActive {
    background-image: url("https://docs.qgis.org/2.2/en/_images/mActionSelect.png");
    background-size: contain;
    filter: hue-rotate(180deg);
    -webkit-filter: hue-rotate(180deg);
}
.olControlPanel .olControlAttributeTableItemInactive {
    background-image: url("http://grass.osgeo.org/grass71/manuals/icons/table.png");
    background-size: contain;
}
.olControlPanel .olControlAttributeTableItemActive {
    background-image: url("http://grass.osgeo.org/grass71/manuals/icons/table.png");
    background-size: contain;
    filter: hue-rotate(180deg);
    -webkit-filter: hue-rotate(180deg);
}
</code></pre>
</div>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">"filter_layer"</span> <span class="na">style=</span><span class="s">"display: none;"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"float: left; padding-right: 20px;"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;p&gt;</span>Filter Layer<span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"expression_1"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"operator"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"||"</span><span class="nt">&gt;</span>OR<span class="nt">&lt;/option&gt;</span>
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"&amp;&amp;"</span><span class="nt">&gt;</span>AND<span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;/select&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"expression_2"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">value=</span><span class="s">"Filter"</span> <span class="na">onclick=</span><span class="s">"filterLayer(this.form)"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;p&gt;</span>Help: Write expressions with relational operators in one or both of the textboxes.<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;</span>The attribute column should be on the left side of the operator, while the value(s) should be on the right side.<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;</span>Neither part of the expression should be put into brackets or quotes.<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;</span>Legal operators:<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;p&gt;&lt;code&gt;</span>==<span class="nt">&lt;/code&gt;</span>, <span class="nt">&lt;code&gt;</span>!=<span class="nt">&lt;/code&gt;</span>, <span class="nt">&lt;code&gt;</span><span class="err">&lt;</span><span class="nt">&lt;/code&gt;</span>, <span class="nt">&lt;code&gt;</span>&gt;<span class="nt">&lt;/code&gt;</span>, <span class="nt">&lt;code&gt;</span><span class="err">&lt;</span>=<span class="nt">&lt;/code&gt;</span>, <span class="nt">&lt;code&gt;</span>&gt;=<span class="nt">&lt;/code&gt;</span>, <span class="nt">&lt;code&gt;</span>..<span class="nt">&lt;/code&gt;</span>(between), <span class="nt">&lt;code&gt;</span>~<span class="nt">&lt;/code&gt;</span>(like), <span class="nt">&lt;code&gt;</span>NULL<span class="nt">&lt;/code&gt;&lt;/p&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>
</div>

<h3 id="data-management-scheme">Data management scheme</h3>

<p>For an easier understanding, we should clarify the scheme before jumping to the code. The datasets are handled as relational tables. This will cost some extra resources, memory or computing time. This example deems memory scarcer than computing time, so we don’t store every attribute in every feature to save some milliseconds. Instead, we iterate through every feature when the attribute names (headers) are needed and return them in an array.</p>

<p>The first field of every feature is its ID. It is mandatory, and it should be written in the fid property. Other fields are stored in the attributes property of the feature. The attributes of the layer are requested on feature creation or an “edit attributes” session. They’re shown as recommended properties and can be filled out by the user, or left empty. The feature only gets those attributes, which have a value other than an empty string.</p>

<p>To reduce overhead, and optimize the application a little bit, the application should store the headers in the <code class="highlighter-rouge">layer</code> object and modify it, if needed. Also, we should be able to delete or add new fields from the attribute table, beside/instead of the editing session. Applying these considerations will be the subject of a future post.</p>

<h3 id="attribute-management">Attribute management</h3>

<p>The first task of this application when it comes to attribute management is to get the attribute names from a layer. As attributes are exclusive to the layers, it can be defined as a member of the layer object.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Layer</span><span class="p">.</span><span class="nx">Vector</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getAttributes</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">headerElems</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">features</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">feature</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">features</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="k">in</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">attributes</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">headerElems</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">j</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">headerElems</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">j</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">headerElems</span><span class="p">;</span>
<span class="p">};</span>
</code></pre>
</div>

<p>Now, as we can get the “headers” from a layer, we can programmatically recommend existent attributes to the user. However, we need a medium which can communicate between the user and the application. For this task, the <code class="highlighter-rouge">OpenLayers.Popup</code> class is perfect. When a user digitizes a point or tries to edit its attributes, a popup pops up (excuse me). It contains a form, which the user fills in, then submits. On submission, the feature gets updated with new values/attributes.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">attrPopup</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//The feature can be wrapped in an event object (digitizing), or passed directly (editing tool).</span>
    <span class="kd">var</span> <span class="nx">feature</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">feature</span> <span class="o">||</span> <span class="nx">evt</span><span class="p">;</span>
    <span class="c1">//Only one popup can be active at a time.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">map</span><span class="p">.</span><span class="nx">popups</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//Create the DOM elements of the form.</span>
        <span class="kd">var</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'div'</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'p'</span><span class="p">);</span>
        <span class="nx">p</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'Attributes:'</span><span class="p">;</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'br'</span><span class="p">));</span>
        <span class="kd">var</span> <span class="nx">form</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'form'</span><span class="p">);</span>
        <span class="nx">form</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'popupForm'</span><span class="p">;</span>
        <span class="c1">//For every existing attribute, create a record. Get the possible attributes with the custom</span>
        <span class="c1">//getAttributes() function.</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">feature</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">features</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">//Create a mandatory ID field, which will be stored in the fid attribute of the feature.</span>
            <span class="kd">var</span> <span class="nx">attrDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'div'</span><span class="p">);</span>
            <span class="nx">attrDiv</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'ID'</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">span</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'span'</span><span class="p">);</span>
            <span class="nx">span</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">':'</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'input'</span><span class="p">);</span>
            <span class="nx">input</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">'fid'</span><span class="p">;</span>
            <span class="nx">input</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">'text'</span><span class="p">;</span>
            <span class="nx">input</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">fid</span><span class="p">;</span>
            <span class="nx">form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">attrDiv</span><span class="p">);</span>
            <span class="nx">form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">span</span><span class="p">);</span>
            <span class="nx">form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
            <span class="nx">form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'br'</span><span class="p">));</span>
            <span class="c1">//Create the rest of the existing attributes.</span>
            <span class="kd">var</span> <span class="nx">headers</span> <span class="o">=</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">getAttributes</span><span class="p">();</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">headers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">attrDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'div'</span><span class="p">);</span>
                <span class="nx">attrDiv</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">headers</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                <span class="nx">attrDiv</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">headers</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                <span class="kd">var</span> <span class="nx">span</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'span'</span><span class="p">);</span>
                <span class="nx">span</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">':'</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'input'</span><span class="p">);</span>
                <span class="nx">input</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">headers</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                <span class="nx">input</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">'text'</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">feature</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">headers</span><span class="p">[</span><span class="nx">i</span><span class="p">]])</span> <span class="p">{</span>
                    <span class="nx">input</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">headers</span><span class="p">[</span><span class="nx">i</span><span class="p">]];</span>
                <span class="p">}</span>
                <span class="nx">form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">attrDiv</span><span class="p">);</span>
                <span class="nx">form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">span</span><span class="p">);</span>
                <span class="nx">form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
                <span class="nx">form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'br'</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1">//Create a button which can add new records.</span>
        <span class="nx">form</span><span class="p">.</span><span class="nx">attributeNum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">newAttr</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'input'</span><span class="p">);</span>
        <span class="nx">newAttr</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">'button'</span><span class="p">;</span>
        <span class="nx">newAttr</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">'New attribute'</span><span class="p">;</span>
        <span class="nx">newAttr</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">property</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'input'</span><span class="p">);</span>
            <span class="nx">property</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">'property_'</span> <span class="o">+</span> <span class="nx">form</span><span class="p">.</span><span class="nx">attributeNum</span><span class="p">;</span>
            <span class="nx">property</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">'text'</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">span</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'span'</span><span class="p">);</span>
            <span class="nx">span</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">':'</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'input'</span><span class="p">);</span>
            <span class="nx">value</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">'value_'</span> <span class="o">+</span> <span class="nx">form</span><span class="p">.</span><span class="nx">attributeNum</span><span class="p">;</span>
            <span class="nx">value</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">'text'</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">property</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">span</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">closeButton</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'button'</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">br</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'br'</span><span class="p">);</span>
            <span class="nx">closeButton</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'X'</span><span class="p">;</span>
            <span class="nx">closeButton</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">'button'</span><span class="p">;</span>
            <span class="nx">closeButton</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">form</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">property</span><span class="p">);</span>
                <span class="nx">form</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">span</span><span class="p">);</span>
                <span class="nx">form</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
                <span class="nx">form</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
                <span class="nx">form</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">br</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">closeButton</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">br</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">attributeNum</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">newAttr</span><span class="p">);</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">form</span><span class="p">);</span>
        <span class="c1">//Create a popup which will sit on the centroid of the geometry. The last parameter is the callback</span>
        <span class="c1">//function on close, which writes the changes to the layer, then removes the popup.</span>
        <span class="kd">var</span> <span class="nx">popup</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Popup</span><span class="p">(</span><span class="s1">'attributes'</span><span class="p">,</span> 
            <span class="nx">feature</span><span class="p">.</span><span class="nx">geometry</span><span class="p">.</span><span class="nx">getBounds</span><span class="p">().</span><span class="nx">getCenterLonLat</span><span class="p">(),</span>
            <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Size</span><span class="p">(</span><span class="mi">260</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
            <span class="s1">''</span><span class="p">,</span>
            <span class="kc">true</span><span class="p">,</span>
            <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">feature</span><span class="p">.</span><span class="nx">fid</span> <span class="o">=</span> <span class="nx">form</span><span class="p">.</span><span class="nx">fid</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">headers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">form</span><span class="p">[</span><span class="nx">headers</span><span class="p">[</span><span class="nx">i</span><span class="p">]].</span><span class="nx">value</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">!==</span> <span class="s1">''</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">feature</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">headers</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">form</span><span class="p">.</span><span class="nx">attributeNum</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">try</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">property</span> <span class="o">=</span> <span class="nx">form</span><span class="p">[</span><span class="s1">'property_'</span> <span class="o">+</span> <span class="nx">i</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
                        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">form</span><span class="p">[</span><span class="s1">'value_'</span> <span class="o">+</span> <span class="nx">i</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">!==</span> <span class="s1">''</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">feature</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">property</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
                        <span class="p">}</span>
                    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
                <span class="p">}</span>
                <span class="nx">map</span><span class="p">.</span><span class="nx">removePopup</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">);</span>
        <span class="nx">popup</span><span class="p">.</span><span class="nx">panMapIfOutOfView</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">map</span><span class="p">.</span><span class="nx">addPopup</span><span class="p">(</span><span class="nx">popup</span><span class="p">);</span>
        <span class="nx">popup</span><span class="p">.</span><span class="nx">contentDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
    <span class="c1">//If there is already a popup, destroy the feature. This way digitizing will be disabled, while there is</span>
    <span class="c1">//an active attribute defining session. Only when digitizing.</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">'featureadded'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">feature</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>As a further consideration, only one popup can be active at a time. Otherwise the map view can be easily filled with popups. This can be achieved by looking at the <code class="highlighter-rouge">popups</code> attribute of the <code class="highlighter-rouge">map</code> object, as popups don’t get grouped in a layer. The rest of the code is mostly DOM manipulation. To deploy this function, we need a way to apply it on feature creation. This can be done by registering the function to a <code class="highlighter-rouge">featureadded</code> event. Note, that the <code class="highlighter-rouge">layer</code> object also has this event, but it fires every time the <code class="highlighter-rouge">features</code> property extends. As there aren’t only one way to extend the <code class="highlighter-rouge">features</code> property (e.g. removing filters), it is a bad approach. We only need to apply this function on new features. Fortunately, the editing tools also have a <code class="highlighter-rouge">featureadded</code> event.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="c1">//Register events, so attributes can be added on feature creation.</span>
<span class="nx">editingToolbar</span><span class="p">.</span><span class="nx">controls</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">events</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s1">'featureadded'</span><span class="p">,</span> <span class="nx">editingToolbar</span><span class="p">.</span><span class="nx">controls</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">attrPopup</span><span class="p">);</span>
<span class="nx">editingToolbar</span><span class="p">.</span><span class="nx">controls</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">events</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s1">'featureadded'</span><span class="p">,</span> <span class="nx">editingToolbar</span><span class="p">.</span><span class="nx">controls</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">attrPopup</span><span class="p">);</span>
<span class="nx">editingToolbar</span><span class="p">.</span><span class="nx">controls</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">events</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s1">'featureadded'</span><span class="p">,</span> <span class="nx">editingToolbar</span><span class="p">.</span><span class="nx">controls</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nx">attrPopup</span><span class="p">);</span>

<span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">EditAttribute</span> <span class="o">=</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Class</span><span class="p">(</span><span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">initialize</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">layer</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">initialize</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="nx">options</span><span class="p">]);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">layer</span> <span class="o">=</span> <span class="nx">layer</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">handler</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Handler</span><span class="p">.</span><span class="nx">Feature</span><span class="p">(</span>
            <span class="k">this</span><span class="p">,</span> <span class="nx">layer</span><span class="p">,</span> <span class="p">{</span><span class="na">click</span><span class="p">:</span> <span class="nx">attrPopup</span><span class="p">}</span>
        <span class="p">);</span>
    <span class="p">},</span>
    <span class="na">setMap</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">map</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">handler</span><span class="p">.</span><span class="nx">setMap</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span>
        <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setMap</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="na">CLASS_NAME</span><span class="p">:</span> <span class="s2">"OpenLayers.Control.EditAttribute"</span>
<span class="p">});</span>
</code></pre>
</div>

<p>Now the popup only gets added, when a new feature is digitized, or when the custom <code class="highlighter-rouge">EditAttribute</code> control gets a feature (the user clicks on one with the control activated). Finally, we define a function for dynamically drawing an attribute table, then create a control for it.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">drawAttrTable</span><span class="p">(</span><span class="nx">layer</span><span class="p">,</span> <span class="nx">select</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">attrWrap</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'attribute_wrap'</span><span class="p">);</span>
    <span class="c1">//Wipe out the previous table if it is still there.</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">attrWrap</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">attrWrap</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">attrWrap</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">//Proceed only when the layer has features.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">layer</span><span class="p">.</span><span class="nx">features</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//Create a column for the mandatory feature ID.</span>
        <span class="kd">var</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'div'</span><span class="p">);</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'attributeTable'</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">tbl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'table'</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">header</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'tr'</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">fid</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'th'</span><span class="p">);</span>
        <span class="nx">fid</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'ID'</span><span class="p">;</span>
        <span class="nx">header</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">fid</span><span class="p">);</span>
        <span class="nx">tbl</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">header</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">headers</span> <span class="o">=</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">getAttributes</span><span class="p">();</span>
        <span class="c1">//Create columns for every other attribute.</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">headers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">attr</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'th'</span><span class="p">);</span>
            <span class="nx">attr</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">headers</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="nx">header</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">attr</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="c1">//If the select argument is true, only list the selected features.</span>
        <span class="kd">var</span> <span class="nx">features</span> <span class="o">=</span> <span class="nx">select</span> <span class="p">?</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">selectedFeatures</span> <span class="p">:</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">features</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="c1">//Create rows for every feature in the input array.</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">features</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">feature</span> <span class="o">=</span> <span class="nx">features</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">featureRow</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'tr'</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">featureID</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'td'</span><span class="p">);</span>
            <span class="nx">featureID</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">fid</span><span class="p">;</span>
            <span class="nx">featureRow</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">featureID</span><span class="p">);</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">j</span><span class="o">&lt;</span><span class="nx">header</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">child</span> <span class="o">=</span> <span class="nx">header</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">child</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">!==</span> <span class="s1">'ID'</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">featureColumn</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'td'</span><span class="p">);</span>
                    <span class="c1">//If the feature doesn't have a value for a given attribute, the record should be empty</span>
                    <span class="c1">//instead of undefined.</span>
                    <span class="nx">featureColumn</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">child</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">]</span> <span class="p">?</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">child</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">]</span> <span class="p">:</span> <span class="s1">''</span><span class="p">;</span>
                    <span class="nx">featureRow</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">featureColumn</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="c1">//If a feature is selected show it with a light blue background.</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">layer</span><span class="p">.</span><span class="nx">selectedFeatures</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">feature</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">featureRow</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="s1">'#CEE3F6'</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">tbl</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">featureRow</span><span class="p">);</span>
            <span class="nx">counter</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">//Create a close button for the table.</span>
        <span class="kd">var</span> <span class="nx">closeButton</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'div'</span><span class="p">);</span>
        <span class="nx">closeButton</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'X'</span><span class="p">;</span>
        <span class="nx">closeButton</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'attributeCloseButton'</span><span class="p">;</span>
        <span class="nx">closeButton</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">attrWrap</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">attrWrap</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">attrWrap</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">attrWrap</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">'none'</span><span class="p">;</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'notifications'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
        <span class="p">};</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">tbl</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">selectedDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'div'</span><span class="p">);</span>
        <span class="nx">selectedDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">clear</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">;</span>
        <span class="c1">//Create an option for displaying only the selected features.</span>
        <span class="kd">var</span> <span class="nx">selectedCheckbox</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'input'</span><span class="p">);</span>
        <span class="nx">selectedCheckbox</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">'checkbox'</span><span class="p">;</span>
        <span class="nx">selectedCheckbox</span><span class="p">.</span><span class="nx">checked</span> <span class="o">=</span> <span class="nx">select</span><span class="p">;</span>
        <span class="nx">selectedCheckbox</span><span class="p">.</span><span class="nx">onchange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">drawAttrTable</span><span class="p">(</span><span class="nx">layer</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">checked</span><span class="p">);</span>
        <span class="p">};</span>
        <span class="nx">selectedDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">selectedCheckbox</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">selectedSpan</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'span'</span><span class="p">);</span>
        <span class="nx">selectedSpan</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'Show selected only'</span><span class="p">;</span>
        <span class="nx">selectedDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">selectedSpan</span><span class="p">);</span>
        <span class="nx">attrWrap</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
        <span class="nx">attrWrap</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">closeButton</span><span class="p">);</span>
        <span class="nx">attrWrap</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">selectedDiv</span><span class="p">);</span>
        <span class="nx">attrWrap</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">'block'</span><span class="p">;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'notifications'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">counter</span> <span class="o">+</span> <span class="s1">' features listed ('</span> <span class="o">+</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">selectedFeatures</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="s1">' selected).'</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">attributeTableControl</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">Button</span><span class="p">({</span>
    <span class="na">title</span><span class="p">:</span> <span class="s1">'Draw attribute table'</span><span class="p">,</span>
    <span class="na">displayClass</span><span class="p">:</span> <span class="s1">'olControlAttributeTable'</span><span class="p">,</span>
    <span class="na">trigger</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">//Draw an attribute table if only one layer is selected.</span>
        <span class="kd">var</span> <span class="nx">layerArr</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">layerDiv</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">layerDiv</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">checked</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">layerArr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">layerArr</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">layer</span> <span class="o">=</span> <span class="nx">layerArr</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="nx">drawAttrTable</span><span class="p">(</span><span class="nx">layer</span><span class="p">);</span>  
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'notifications'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'No or too many layer(s) selected.'</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre>
</div>

<p>The function iterates through the features two times. First it collects the unique attribute names, then the values. This can be optimized and reduced to one iteration. The control now doesn’t extend the <code class="highlighter-rouge">OpenLayers.Control</code> class, it is defined as a button control which calls the function if its requirements are met.</p>

<h3 id="filters-and-selections">Filters and selections</h3>

<p>Filtering and selecting systems are built-in functionalities in OpenLayers 2. There is a default styling for selected features, a selection control, and an <code class="highlighter-rouge">OpenLayers.Filter</code> class just to mention a few. This section shows how to utilize selecting and filtering by attributes. First, we add a simple <code class="highlighter-rouge">SelectFeature</code> control with a little spice. It has basic selection capabilities on mouse click, and can switch to the selected layer to activation. Because its internal <code class="highlighter-rouge">setLayer</code> function reactivates the control, it gets stuck in a loop whenever it is activated. To avoid this, we implement an <code class="highlighter-rouge">avoidLoop</code> boolean attribute, which grabs the control out of loop after <code class="highlighter-rouge">setLayer</code> has been called.</p>

<pre><code class="language-javacsript">var selectControl = new OpenLayers.Control.SelectFeature(vect, {
    title: 'Select features',
    multiple: true,
    clickout: false,
    toggle: true,
    avoidLoop: false,
    eventListeners: {
        activate: function() {
            var layerArray = [];
            for (var i=0;i&lt;this.map.layers.length;i++) {
                if (this.map.layers[i].layerDiv.children[2].checked === true) {
                    layerArray.push(this.map.layers[i]);
                }
            }
            if (layerArray.length === 1) {
                if (this.avoidLoop === false) {
                    this.avoidLoop = true;
                    this.setLayer(layerArray[0]);
                } else {
                    this.avoidLoop = false;
                }
            }
        }
    }
});
</code></pre>

<p>Next, we add filter controls. The trickiest part in filters is writing a form, which can be used easily and effectively by the user. There are a lot of options, and we shouldn’t limit the user in writing expressions with fixed forms. However, for the sake of simplicity I’ve implemented a basic form with two comparisons and one logical operator. The comparison expressions can be written freely, so we need a simple parsing function which creates a filter based on them.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">parseFilterExp</span><span class="p">(</span><span class="nx">expression</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">expArray</span> <span class="o">=</span> <span class="nx">expression</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">expArray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">===</span> <span class="s1">'..'</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">filter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">Comparison</span><span class="p">({</span>
            <span class="na">type</span><span class="p">:</span> <span class="s1">'..'</span><span class="p">,</span>
            <span class="na">property</span><span class="p">:</span> <span class="nx">expArray</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="na">lowerBoundary</span><span class="p">:</span> <span class="nx">expArray</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="na">upperBoundary</span><span class="p">:</span> <span class="nx">expArray</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="p">});</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">expArray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">===</span> <span class="s1">'NULL'</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">filter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">Comparison</span><span class="p">({</span>
            <span class="na">type</span><span class="p">:</span> <span class="s1">'NULL'</span><span class="p">,</span>
            <span class="na">property</span><span class="p">:</span> <span class="nx">expArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">});</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">filter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">Comparison</span><span class="p">({</span>
            <span class="na">type</span><span class="p">:</span> <span class="nx">expArray</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="na">property</span><span class="p">:</span> <span class="nx">expArray</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="na">value</span><span class="p">:</span> <span class="nx">expArray</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">filter</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p>As we can parse simple expressions, we can write the filter functions. One of them is a hard filter, which removes every feature which get evaluated as false by the filter. The other one is a selection tool, which selects the filtered features. The hard filter works with a filter strategy, which needs to be accessed easily despite of how many strategies are applied. To do this, we make a dedicated property for the strategy. Also, if there is a syntax error in a <code class="highlighter-rouge">LIKE</code> expression, which gets evaluated by a regular expression, the features get removed from the layer. To prevent this, we wrap the filter in a try-catch clause, which throws an error message if the filter fails to apply.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">filterLayer</span><span class="p">(</span><span class="nx">form</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">layerArr</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">layerDiv</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">layerDiv</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">checked</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">layerArr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">layerArr</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">layer</span> <span class="o">=</span> <span class="nx">layerArr</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">filterStrategy</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">layer</span><span class="p">.</span><span class="nx">filterStrategy</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Strategy</span><span class="p">.</span><span class="nx">Filter</span><span class="p">();</span>
            <span class="nx">layer</span><span class="p">.</span><span class="nx">filterStrategy</span><span class="p">.</span><span class="nx">setLayer</span><span class="p">(</span><span class="nx">layer</span><span class="p">);</span>
            <span class="nx">layer</span><span class="p">.</span><span class="nx">filterStrategy</span><span class="p">.</span><span class="nx">activate</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">form</span><span class="p">.</span><span class="nx">expression_1</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="s1">''</span> <span class="o">||</span> <span class="nx">form</span><span class="p">.</span><span class="nx">expression_2</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="s1">''</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">form</span><span class="p">.</span><span class="nx">expression_1</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="s1">''</span> <span class="o">&amp;&amp;</span> <span class="nx">form</span><span class="p">.</span><span class="nx">expression_2</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="s1">''</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">exp1</span> <span class="o">=</span> <span class="nx">form</span><span class="p">.</span><span class="nx">expression_1</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">exp2</span> <span class="o">=</span> <span class="nx">form</span><span class="p">.</span><span class="nx">expression_2</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">logical</span> <span class="o">=</span> <span class="nx">form</span><span class="p">.</span><span class="nx">operator</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">filter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">Logical</span><span class="p">({</span>
                    <span class="na">type</span><span class="p">:</span> <span class="nx">logical</span><span class="p">,</span>
                    <span class="na">filters</span><span class="p">:</span> <span class="p">[</span>
                        <span class="nx">parseFilterExp</span><span class="p">(</span><span class="nx">exp1</span><span class="p">),</span>
                        <span class="nx">parseFilterExp</span><span class="p">(</span><span class="nx">exp2</span><span class="p">)</span>
                    <span class="p">]</span>
                <span class="p">});</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">exp1</span> <span class="o">=</span> <span class="nx">form</span><span class="p">.</span><span class="nx">expression_1</span><span class="p">.</span><span class="nx">value</span> <span class="o">||</span> <span class="nx">form</span><span class="p">.</span><span class="nx">expression_2</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">filter</span> <span class="o">=</span> <span class="nx">parseFilterExp</span><span class="p">(</span><span class="nx">exp1</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">filter</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="nx">layer</span><span class="p">.</span><span class="nx">filterStrategy</span><span class="p">.</span><span class="nx">setFilter</span><span class="p">(</span><span class="nx">filter</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">SyntaxError</span> <span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">closeDialog</span><span class="p">();</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'notifications'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">features</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="s1">' features filtered (out of '</span> <span class="o">+</span> <span class="p">(</span><span class="nx">layer</span><span class="p">.</span><span class="nx">filterStrategy</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">features</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="o">+</span> <span class="s1">').'</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'notifications'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'No or too many layer(s) selected.'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>For the selection function, we don’t want to duplicate the selection controls, so we call the one, which has been added previously. We evaluate every feature with the specified filter, then if it returns a true, we select it with the control’s select method. This way the selection control functions as a deselecting agent if activated later. In our case this considered a feature, but if in another environment it is a bug, you can dedicate a new <code class="highlighter-rouge">SelectFeatures</code> control to the function. Also, the function removes all of the previous selections prior to making a new one.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">filterAttribute</span><span class="p">(</span><span class="nx">form</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">layerArr</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">layerDiv</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">layerDiv</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">checked</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">layerArr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">layerArr</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">layer</span> <span class="o">=</span> <span class="nx">layerArr</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">selectAgent</span> <span class="o">=</span> <span class="nx">map</span><span class="p">.</span><span class="nx">getControlsByClass</span><span class="p">(</span><span class="s1">'OpenLayers.Control.SelectFeature'</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">selectedFeatures</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">selectedFeatures</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">selectAgent</span><span class="p">.</span><span class="nx">setLayer</span><span class="p">(</span><span class="nx">map</span><span class="p">.</span><span class="nx">layers</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                    <span class="nx">selectAgent</span><span class="p">.</span><span class="nx">unselectAll</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">form</span><span class="p">.</span><span class="nx">expression_1</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="s1">''</span> <span class="o">||</span> <span class="nx">form</span><span class="p">.</span><span class="nx">expression_2</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="s1">''</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">form</span><span class="p">.</span><span class="nx">expression_1</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="s1">''</span> <span class="o">&amp;&amp;</span> <span class="nx">form</span><span class="p">.</span><span class="nx">expression_2</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="s1">''</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">exp1</span> <span class="o">=</span> <span class="nx">form</span><span class="p">.</span><span class="nx">expression_1</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">exp2</span> <span class="o">=</span> <span class="nx">form</span><span class="p">.</span><span class="nx">expression_2</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">logical</span> <span class="o">=</span> <span class="nx">form</span><span class="p">.</span><span class="nx">operator</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">filter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">Logical</span><span class="p">({</span>
                    <span class="na">type</span><span class="p">:</span> <span class="nx">logical</span><span class="p">,</span>
                    <span class="na">filters</span><span class="p">:</span> <span class="p">[</span>
                        <span class="nx">parseFilterExp</span><span class="p">(</span><span class="nx">exp1</span><span class="p">),</span>
                        <span class="nx">parseFilterExp</span><span class="p">(</span><span class="nx">exp2</span><span class="p">)</span>
                    <span class="p">]</span>
                <span class="p">});</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">exp1</span> <span class="o">=</span> <span class="nx">form</span><span class="p">.</span><span class="nx">expression_1</span><span class="p">.</span><span class="nx">value</span> <span class="o">||</span> <span class="nx">form</span><span class="p">.</span><span class="nx">expression_2</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">filter</span> <span class="o">=</span> <span class="nx">parseFilterExp</span><span class="p">(</span><span class="nx">exp1</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">layer</span><span class="p">.</span><span class="nx">features</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">filter</span><span class="p">.</span><span class="nx">evaluate</span><span class="p">(</span><span class="nx">layer</span><span class="p">.</span><span class="nx">features</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">selectAgent</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">layer</span><span class="p">.</span><span class="nx">features</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'notifications'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">selectedFeatures</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="s1">' features selected (out of '</span> <span class="o">+</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">features</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="s1">').'</span><span class="p">;</span>
            <span class="nx">closeDialog</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'notifications'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'No filter expression.'</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'notifications'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'No or too many layer(s) selected.'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>
<div>
<div class="menuToggle" id="menu_new">
&nbsp;New
<div class="menuContent" id="menu_new_content" style="display: none;">
<div data-dialog="new_wms" onclick="openDialog(this)">
WMS Layer</div>
<div data-dialog="new_wfs" onclick="openDialog(this)">
WFS Layer</div>
<div data-dialog="new_vector" onclick="openDialog(this)">
Vector Layer</div>
</div>
</div>
<div class="menuToggle" id="menu_open">
&nbsp;Open
<div class="menuContent" id="menu_open_content" style="display: none;">
<div data-dialog="open_image" onclick="openDialog(this)">
Image Layer</div>
<div data-dialog="open_vector" onclick="openDialog(this)">
Vector Layer</div>
</div>
</div>
<div class="menuToggle" id="menu_filter">
&nbsp;Filter
<div class="menuContent" id="menu_filter_content" style="display: none;">
<div data-dialog="filter_layer" onclick="openDialog(this)">
Filter Layer</div>
<div data-dialog="filter_attribute" onclick="openDialog(this)">
Select by attribute</div>
</div>
</div>
</div>
<div class="menuToggle" id="delete" onclick="deleteLayers()">
&nbsp;Delete</div>
<table style="height: 500px; table-layout: fixed; width: 720px;">
<tbody style="vertical-align: top;">
<tr>
        <td style="width: 200px;"><div id="layerControl_wrap" style="max-height: 500px; overflow: auto; width: 220px;">
Layers:<br />
<p>Name</p>
<img src="/assets/js/OpenLayers/theme/default/img/draw_point_on.png" style="height: 20px; width: 20px;" title="Edit layer" />
                <img src="/assets/js/OpenLayers/theme/default/img/overview_replacement.gif" style="height: 20px; width: 20px;" title="Select layer" />
<div style="border: 1px solid black; display: inline-block; height: 20px; position: relative; text-align: center; top: -4px; width: 20px;" title="Raise layer">
⇧</div>
<div style="border: 1px solid black; display: inline-block; height: 20px; position: relative; text-align: center; top: -4px; width: 20px;" title="Lower layer">
⇩</div>
<div id="layerControl">
</div>
</div>
</td>
        <td style="width: 500px;"><div id="map" style="height: 500px; width: 500px;">
</div>
</td>
    </tr>
</tbody>
</table>
<table style="table-layout: fixed; width: 720px;">
    <tbody>
<tr style="height: 20px;">
        <td style="width: 200px;"></td>
        <td style="width: 300px;"><span id="notifications"></span>
        </td>
        <td style="text-align: right; width: 200px;"><span id="coordinates"></span>
        </td>
    </tr>
</tbody></table>
<div id="attribute_wrap" style="display: none;">
</div>
<div id="dialog_wrap">
<form id="new_wms" style="display: none;">
New WMS layer<br />
<table>
            <tbody>
<tr>
                <td title="URL of the WMS server.">Server URL:</td>
                <td><input name="server" type="text" /></td>
                <td><input onclick="checkWmsLayer(this.form)" type="button" value="Check for layers" /></td>
            </tr>
<tr>
                <td title="Name of the layer on the WMS server.">Layer name:</td>
                <td><input name="layer" type="text" /><select name="layerSel" style="display: none; max-width: 150px;"></select></td>
            </tr>
<tr>
                <td title="Display name in OpenLayers.">Display name:</td>
                <td><input name="lyrname" type="text" /></td>
            </tr>
<tr>
                <td title="Layer transparency.">Transparency:</td>
                <td><input checked="true" name="transp" type="checkbox" /></td>
            </tr>
<tr>
                <td><br /></td>
            </tr>
<tr>
                <td><input onclick="addWmsLayer(this.form)" type="button" value="Create layer" /></td>
            </tr>
</tbody></table>
</form>
<form id="new_wfs" style="display: none;">
New WFS layer<br />
<table>
            <tbody>
<tr>
                <td title="URL of the WFS server.">Server URL:</td>
                <td><input name="server" type="text" /></td>
            </tr>
<tr>
                <td title="Name of the &quot;layer&quot; on the WFS server.">Layer:</td>
                <td><input name="lyrtype" type="text" /></td>
            </tr>
<tr>
                <td title="Namespace of the feature type.">Namespace (optional):</td>
                <td><input name="ns" type="text" /></td>
            </tr>
<tr>
                <td title="Display name in OpenLayers.">Display name:</td>
                <td><input name="lyrname" type="text" /></td>
            </tr>
<tr>
                <td><br /></td>
            </tr>
<tr>
                <td><input onclick="addWfsLayer(this.form)" type="button" value="Create layer" /></td>
            </tr>
</tbody></table>
</form>
<form id="new_vector" style="display: none;">
New Vector layer<br />
<table>
            <tbody>
<tr>
                <td title="Type of the vector layer.">Feature type:</td>
                <td><select name="lyrtype">
                        <option value="POINT">Point</option>
                        <option value="LINE">Line</option>
                        <option value="POLYGON">Polygon</option>
                        <option value="COLLECTION">Geometry collection</option>
                    </select>
                </td>
            </tr>
<tr>
                <td title="Display name in OpenLayers.">Display name:</td>
                <td><input name="lyrname" type="text" /></td>
            </tr>
<tr>
                <td><br /></td>
            </tr>
<tr>
                <td><input onclick="addVectorLayer(this.form)" type="button" value="Create layer" /></td>
            </tr>
</tbody></table>
</form>
<form id="open_image" style="display: none;">
Open Image layer<br />
<table>
            <tbody>
<tr>
                <td>Image from URL</td>
            </tr>
<tr>
                <td title="URL of the image.">Image URL:</td>
                <td><input name="url" type="text" /></td>
            </tr>
<tr>
                <td>Image from file</td>
            </tr>
<tr>
                <td title="Path of the image.">Image path:</td>
                <td><input accept="image/*" name="file" type="file" /></td>
            </tr>
<tr>
                <td title="Boundary coordinates of the image. Leave blank for non-georeferenced image.">Image extent (W,S,E,N):</td>
                <td><input name="extent" type="text" /></td>
            </tr>
<tr>
                <td title="Display name in OpenLayers.">Display name:</td>
                <td><input name="lyrname" type="text" /></td>
            </tr>
<tr>
                <td><br /></td>
            </tr>
<tr>
                <td><input onclick="openImageLayer(this.form)" type="button" value="Create layer (URL)" /></td>
                <td><input onclick="openImageFile(this.form)" type="button" value="Create layer (file)" /></td>
            </tr>
</tbody></table>
</form>
<form id="open_vector" style="display: none;">
Open Vector layer<br />
<table>
            <tbody>
<tr>
                <td title="Projection of the vector layer.">Projection:</td>
                <td><select name="proj">
                        <option value="EPSG:4326">EPSG:4326</option>
                        <option value="EPSG:3857">EPSG:3857</option>
                    </select>
                </td>
            </tr>
<tr>
                <td title="Format of the vector layer.">Format:</td>
                <td><select name="format">
                        <option value="geojson">GeoJSON</option>
                        <option value="kml">KML</option>
                        <option value="osm">OSM</option>
                        <option value="wkt">WKT</option>
                    </select>
                </td>
            </tr>
<tr>
                <td title="Type of the vector layer.">Feature type:</td>
                <td><select name="lyrtype">
                        <option value="POINT">Point</option>
                        <option value="LINE">Line</option>
                        <option value="POLYGON">Polygon</option>
                        <option value="COLLECTION">Geometry collection</option>
                    </select>
                </td>
            </tr>
<tr>
                <td title="Path of the vetor.">Vector path:</td>
                <td><input name="file" type="file" /></td>
            </tr>
<tr>
                <td title="Display name in OpenLayers.">Display name:</td>
                <td><input name="lyrname" type="text" /></td>
            </tr>
<tr>
                <td><br /></td>
            </tr>
<tr>
                <td><input onclick="openVectorLayer(this.form)" type="button" value="Open layer" /></td>
            </tr>
</tbody></table>
</form>
<form id="filter_layer" style="display: none;">
<div style="float: left; padding-right: 20px;">
Filter Layer<br />
<input name="expression_1" type="text" />
        <br />
<select name="operator">
            <option value="||">OR</option>
            <option value="&amp;&amp;">AND</option>
        </select>
        <br />
<input name="expression_2" type="text" />
        <br />
<br />
<input onclick="filterLayer(this.form)" type="button" value="Filter" />
    </div>
Help: Write expressions with relational operators in one or both of the textboxes.<br />
The attribute column should be on the left side of the operator, while the value(s) should be on the right side.<br />
Neither part of the expression should be put into brackets or quotes.<br />
Legal operators:<br />
<code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>..</code>(between), <code>~</code>(like), <code>NULL</code></form>
<form id="filter_attribute" style="display: none;">
<div style="float: left; padding-right: 20px;">
Select by attribute<br />
<input name="expression_1" type="text" />
        <br />
<select name="operator">
            <option value="||">OR</option>
            <option value="&amp;&amp;">AND</option>
        </select>
        <br />
<input name="expression_2" type="text" />
        <br />
<br />
<input onclick="filterAttribute(this.form)" type="button" value="Select" />
    </div>
Help: Write expressions with relational operators in one or both of the textboxes.<br />
The attribute column should be on the left side of the operator, while the value(s) should be on the right side.<br />
Neither part of the expression should be put into brackets or quotes.<br />
Legal operators:<br />
<code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>..</code>(between), <code>~</code>(like), <code>NULL</code></form>
</div>

<script src="/assets/js/OpenLayers/OpenLayers.js" type="text/javascript"></script>

<script src="/assets/js/openlayers-webgis-3.js" type="text/javascript"></script>


  </article>

  
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname  = 'gaborfarkas-github-io';
      var disqus_identifier = '/blog/2015/openlayers-webgis-3';
      var disqus_title      = "WebGIS application with OpenLayers 2 - Part 3: Data management";
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  

</div>

      </div>
    </div>

    <footer>

  <div class="wrapper">
    &copy; Copyright 2019 Gábor Farkas.
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.

    
  </div>

</footer>


    <!-- Load jQuery -->
<script src="//code.jquery.com/jquery-1.12.4.min.js"></script>

<!-- Load Common JS -->
<script src="https://gaborfarkas.github.io/assets/js/common.js"></script>


<!-- Load KaTeX -->
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js"></script>
<script src="https://gaborfarkas.github.io/assets/js/katex.js"></script>




<!-- Include custom icon fonts -->
<link rel="stylesheet" href="https://gaborfarkas.github.io/assets/css/font-awesome.min.css">
<link rel="stylesheet" href="https://gaborfarkas.github.io/assets/css/academicons.min.css">

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-107151753-1', 'auto');
  ga('send', 'pageview');

</script>


  </body>

</html>
